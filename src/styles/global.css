@import "tailwindcss";

/* biome-ignore lint: skip biome lint */
@plugin '@tailwindcss/typography';

/* Self-hosted Roboto Mono Regular */
@font-face {
	font-family: "Roboto Mono";
	src: url("/fonts/roboto-mono-regular.woff2") format("woff2");
	font-weight: 400;
	font-style: normal;
	font-display: swap;
}

html {
	font-size: 85%; /* Scale everything down by 10% */
}

body {
	font-family:
		"Roboto Mono", -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu",
		"Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

code {
	font-family: source-code-pro, Menlo, Monaco, Consolas, "Courier New", monospace;
}

:root {
	--navbar-height: 3.5rem;
	--anchor-offset: var(--navbar-height);
	--background: #fdf9f6;
	--foreground: oklch(0.141 0.005 285.823);
	--card: oklch(1 0 0);
	--card-foreground: oklch(0.141 0.005 285.823);
	--muted: oklch(0.967 0.001 286.375);
	--background-secondary: #fefcfa;
	--muted-foreground: oklch(0.552 0.016 285.938);
	--border: oklch(0.92 0.004 286.32);
	--ring: oklch(0.871 0.006 286.286);
	--radius: 0.625rem;
}

.dark {
	--background: oklch(0.141 0.005 285.823);
	--foreground: oklch(0.985 0 0);
	--card: oklch(0.141 0.005 285.823);
	--card-foreground: oklch(0.985 0 0);
	--muted: oklch(0.274 0.006 286.033);
	--muted-foreground: oklch(0.705 0.015 286.067);
	--border: oklch(0.274 0.006 286.033);
	--ring: oklch(0.442 0.017 285.786);
}

@layer base {
	/* Ensure headings with anchor links offset correctly for sticky navbar */
	h1[id],
	h2[id],
	h3[id],
	h4[id],
	h5[id],
	h6[id] {
		scroll-margin-top: var(--anchor-offset);
	}
}

/* Overwride tailwaind typography's inserted backticks */
code::before {
	content: "";
}
code::after {
	content: "";
}

/* Code blocks & inline code overrides */
.astro-code {
	/* container look */
	background: var(--background-secondary);
	border: 1px solid var(--border);
	border-radius: var(--radius-lg);
	padding: 0.875rem 1rem;
	overflow-x: auto;
	box-shadow: none;
	outline: none;
	position: relative;
}

/* inline code */
.prose :not(pre) > code {
	background: color-mix(in oklch, var(--background-secondary) 90%, transparent);
	border: 0.2px solid var(--border);
	border-radius: calc(var(--radius-sm));
	padding: 0.15em 0.35em;
	font-size: 0.85em;
	font-weight: 400;
}

/* Markdown rendering now uses Tailwind Typography (prose) */
.prose {
	text-align: justify;
	text-justify: inter-word;
	max-width: none;
}

/* Headings should not be justified */
.prose h1,
.prose h2,
.prose h3,
.prose h4,
.prose h5,
.prose h6 {
	text-align: left;
}

/* Code blocks should not be justified */
.prose pre {
	text-align: left;
}

/* Copy button micro-interactions */
@keyframes copy-pop {
	0% {
		transform: scale(1);
	}
	50% {
		transform: scale(1.07);
	}
	100% {
		transform: scale(1);
	}
}

.copy-btn {
	position: absolute;
	top: 8px;
	right: 8px;
	padding: 0.25rem 0.5rem;
	font-size: 0.75rem;
	line-height: 1;
	border: 1px solid var(--border);
	border-radius: var(--radius-sm);
	background: color-mix(in oklch, var(--background-secondary) 85%, transparent);
	color: inherit;
	opacity: 0;
	cursor: pointer;
	transition:
		opacity 150ms ease,
		transform 120ms ease,
		box-shadow 150ms ease;
	user-select: none;
}
.prose pre:hover .copy-btn {
	opacity: 1;
}
.copy-btn:active {
	transform: scale(0.96);
}
.copy-btn.copied {
	animation: copy-pop 300ms ease-out;
}
